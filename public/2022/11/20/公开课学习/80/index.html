<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="description" content="good study, day day up">
  <meta name="keyword" content="hexo-theme, vuejs">
  
    <link rel="shortcut icon" href="/css/images/logo.png">
  
  <title>
    
      【build a computer】 project 10 | 且听疯吟
    
  </title>
  <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="//cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.css" rel="stylesheet">
  <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow.min.css" rel="stylesheet">
  
<link rel="stylesheet" href="/css/style.css">

  
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/geopattern/1.2.3/js/geopattern.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.js"></script>
  
    
<script src="/js/qrious.js"></script>

  
  
  
  
    <!-- MathJax support START -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- MathJax support END -->
  


  
  
    
<script src="/js/local-search.js"></script>


<meta name="generator" content="Hexo 7.2.0"></head>
<div class="wechat-share">
  <img src="/css/images/logo.png" />
</div>
  <body>
    <header class="header fixed-header">
  <div class="header-container">
    <a class="home-link" href="/">
      <div class="logo"></div>
      <span>且听疯吟</span>
    </a>
    <ul class="right-list">
      
        <li class="list-item">
          
            <a href="/" class="item-link">Home</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/series/" class="item-link">Series</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/tags/" class="item-link">Tags</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/archives/" class="item-link">Archives</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/project/" class="item-link">Projects</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/about/" class="item-link">About</a>
          
        </li>
      
      
        <li class="menu-item menu-item-search right-list">
    <a role="button" class="popup-trigger">
        <i class="fa fa-search fa-fw"></i>
    </a>
</li>
      
    </ul>
    <div class="menu">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </div>
    <div class="menu-mask">
      <ul class="menu-list">
        
          <li class="menu-item">
            
              <a href="/" class="menu-link">Home</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/series/" class="menu-link">Series</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/tags/" class="menu-link">Tags</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/archives/" class="menu-link">Archives</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/project/" class="menu-link">Projects</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/about/" class="menu-link">About</a>
            
          </li>
        
      </ul>
    </div>
    
      <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
            <span class="search-icon">
                <i class="fa fa-search"></i>
            </span>
            <div class="search-input-container">
                <input autocomplete="off" autocapitalize="off"
                    placeholder="Please enter your keyword(s) to search." spellcheck="false"
                    type="search" class="search-input">
            </div>
            <span class="popup-btn-close">
                <i class="fa fa-times-circle"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>
    
  </div>
</header>

    <div id="article-banner">
  <h2>【build a computer】 project 10</h2>
  <p class="post-date">2022-11-20</p>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>
<main class="app-body flex-box">
  <!-- Article START -->
  <article class="post-article">
    <section class="markdown-content"><h1 id="week9"><a href="#week9" class="headerlink" title="week9"></a>week9</h1><p>目前已经开始了<code>build a computer</code>系列的最后几章了，后面的章节感觉越来越难，<code>build a computer</code>的<code>part II</code>部分基本上全是软件，需要编码，耗费大量的实践和精力来应付这些代码，不过能够最终通过测试的话还是成就满满。特别是只剩下后面三章了，主要是完成一个<code>jack</code>语言编译器和一个最基本的微型操作系统，并提供基本的系统库函数。<code>project10</code>主要完成<code>jack</code>语言编译器的语法分析，感觉还是非常有难度和挑战的，花了差不多两周时间，利用子集的业余时间终于把蹩脚的语法解析器完成了，主要是关于<code>jack</code>语言的语法分析。收获满满，最终的实现结果是将<code>jack</code>语言的语法分析结果结构化为固定的<code>xml</code>文档，供后面的代码生成器和链接器使用。当然总体来说<code>jack</code>语言的语法还是非常简单的语法，我们直接用常见的<code>top down</code>递归下降分析法即可实现，实际是非常简单的语法，至少感觉总体语法来说比<code>c</code>语言的语法简单多了，非常喜欢这类有挑战性的小<code>project</code>，感觉对基本的递归方法有了更深层次的了解。</p>
<ul>
<li><code>Lexical elements</code>: 词的定义，在<code>jack</code>语言中词的定义非常简单，只有5类基本类型，如下所示：</li>
</ul>
<p><img src="https://i.loli.net/2020/12/10/8ysJVnjkYBwFfZr.png" alt="1"><br>关键字、符号、整数常数、字符串常数、普通标识符。</p>
<ul>
<li><ul>
<li>关键字即可语法中的关键字，不可随意使用</li>
</ul>
</li>
<li><ul>
<li>特殊符号即为过程标志位和运算符</li>
</ul>
</li>
<li><ul>
<li>整数常数 (0~32767)</li>
</ul>
</li>
<li><ul>
<li>字符串常数 (“xxx”)</li>
</ul>
</li>
<li><ul>
<li>普通标识符</li>
</ul>
</li>
<li><p><code>Program structure</code>:结构语法，包含基本的程序结构定义</p>
</li>
</ul>
<p><img src="https://i.loli.net/2020/12/10/3ApEQqrJysU8Goi.png" alt="2"></p>
<ul>
<li><code>Statements</code>：语句定义，还是非常常见的语句定义</li>
</ul>
<p><img src="https://i.loli.net/2020/12/10/QTFPaLnK9RoevUq.png" alt="3"></p>
<ul>
<li><code>Expressions</code>:表达式定义，包含常见的表达式定义:</li>
</ul>
<p><img src="https://i.loli.net/2020/12/10/VcQwuEijCeAaMgy.png"><br>整个<code>project</code>基本围绕着上述几个语法展开，实际还是非常有意思的，需要对递归非常熟悉才可以对整个代码比较好的掌握</p>
<h2 id="project"><a href="#project" class="headerlink" title="project"></a>project</h2><p>本周的<code>project</code>还是非常有难度的<code>project</code>，刚开始准备用<code>c++</code>来实现，后来发现<code>c++</code>太恶心了点，最后用蹩脚的<code>python</code>花了大概一个星期终于实现了整个<code>project</code>，整个程序的流程也分为两部分，先将整个程序进行<code>token</code>格式化，后续的分析引擎对整个语法树进行分析，生成树状结构的<code>xml</code>文件，当然总的来说本章的<code>project</code>有难度，但是不够有趣，感觉<code>csapp</code>的<code>project</code>难度非常大，不是一般人能够坚持完成的，目前的打算是准备把<code>build a computer</code>这个系列的课程的<code>project</code>代码完整的实现一遍，终于磨蹭了这么长时间只剩下最后两个<code>project</code>了。源代码放在<br><a target="_blank" rel="noopener" href="https://github.com/mike-box/coursera/tree/master/Build%20a%20computer/nand2tetris/nand2tetris/projects/10">poj10</a>.</p>
<ul>
<li><code>token parser</code>：整个程序非常简单，其实大概核心的代码<code>100</code>行即可完成<code>token</code>解析，非常简单的代码逻辑即可实现。<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> fileinput</span><br><span class="line"><span class="keyword">import</span> sys, getopt</span><br><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum, unique</span><br><span class="line"></span><br><span class="line"><span class="meta">@unique</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TOKEN_TYPE</span>(<span class="title class_ inherited__">Enum</span>):</span><br><span class="line">    TOKEN_KEYWORD = <span class="number">0</span></span><br><span class="line">    TOKEN_SYMBOL = <span class="number">1</span></span><br><span class="line">    TOKEN_IDENTIFIER = <span class="number">2</span></span><br><span class="line">    TOKEN_INT_CONST = <span class="number">3</span></span><br><span class="line">    TOKEN_STRING_CONST = <span class="number">4</span></span><br><span class="line">    TOKEN_INVALID = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@unique</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">KEYWORD_TYPE</span>(<span class="title class_ inherited__">Enum</span>):</span><br><span class="line">    KEYWORD_CLASS = <span class="number">101</span></span><br><span class="line">    KEYWORD_METHOD = <span class="number">102</span></span><br><span class="line">    KEYWORD_FUNCTION = <span class="number">103</span></span><br><span class="line">    KEYWORD_CONSTRUCTOR = <span class="number">104</span></span><br><span class="line">    KEYWORD_BOOLEAN = <span class="number">105</span></span><br><span class="line">    KEYWORD_CHAR = <span class="number">106</span></span><br><span class="line">    KEYWORD_VOID = <span class="number">107</span></span><br><span class="line">    KEYWORD_VAR = <span class="number">108</span></span><br><span class="line">    KEYWORD_STATIC = <span class="number">109</span></span><br><span class="line">    KEYWORD_FIELD = <span class="number">110</span></span><br><span class="line">    KEYWORD_LET = <span class="number">111</span></span><br><span class="line">    KEYWORD_DO = <span class="number">112</span></span><br><span class="line">    KEYWORD_IF = <span class="number">113</span></span><br><span class="line">    KEYWORD_WHILE = <span class="number">114</span></span><br><span class="line">    KEYWORD_RETURN = <span class="number">115</span></span><br><span class="line">    KEYWORD_TRUE = <span class="number">116</span></span><br><span class="line">    KEYWORD_FALSE = <span class="number">117</span></span><br><span class="line">    KEYWORD_NULL = <span class="number">118</span></span><br><span class="line">    KEYWORD_THIS = <span class="number">119</span></span><br><span class="line">    KEYWORD_VALID = <span class="number">120</span></span><br><span class="line"></span><br><span class="line">keywordname = [<span class="string">&quot;class&quot;</span>,<span class="string">&quot;method&quot;</span>,<span class="string">&quot;function&quot;</span>,<span class="string">&quot;constructor&quot;</span>,<span class="string">&quot;boolean&quot;</span>,<span class="string">&quot;char&quot;</span>,<span class="string">&quot;void&quot;</span>,<span class="string">&quot;var&quot;</span>,<span class="string">&quot;static&quot;</span></span><br><span class="line">               ,<span class="string">&quot;field&quot;</span>,<span class="string">&quot;let&quot;</span>,<span class="string">&quot;do&quot;</span>,<span class="string">&quot;if&quot;</span>,<span class="string">&quot;else&quot;</span>,<span class="string">&quot;while&quot;</span>,<span class="string">&quot;return&quot;</span>,<span class="string">&quot;true&quot;</span>,<span class="string">&quot;false&quot;</span>,<span class="string">&quot;null&quot;</span>,<span class="string">&quot;this&quot;</span>]</span><br><span class="line">keywordtype = [name <span class="keyword">for</span> name, member <span class="keyword">in</span> KEYWORD_TYPE.__members__.items()]</span><br><span class="line">keworddict = <span class="built_in">dict</span>(<span class="built_in">zip</span>(keywordname,keywordtype))</span><br><span class="line">tokenname = [<span class="string">&quot;keyword&quot;</span>,<span class="string">&quot;symbol&quot;</span>,<span class="string">&quot;identifier&quot;</span>,<span class="string">&quot;integerConstant&quot;</span>,<span class="string">&quot;stringConstant&quot;</span>]</span><br><span class="line">tokentype = [name <span class="keyword">for</span> name, member <span class="keyword">in</span> TOKEN_TYPE.__members__.items()]</span><br><span class="line">tokendict = <span class="built_in">dict</span>(<span class="built_in">zip</span>(tokentype,tokenname))</span><br><span class="line">symboldict = <span class="built_in">set</span>([<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;)&#x27;</span>,<span class="string">&#x27;[&#x27;</span>,<span class="string">&#x27;]&#x27;</span>,<span class="string">&#x27;,&#x27;</span>,<span class="string">&#x27;;&#x27;</span>,<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;/&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;|&#x27;</span>,<span class="string">&#x27;~&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;&gt;&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validNum</span>(<span class="params">val</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(val) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> val[<span class="number">0</span>] == <span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> <span class="built_in">len</span>(val) &gt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> val:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(c) &lt; <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>) <span class="keyword">or</span> <span class="built_in">ord</span>(c) &gt; <span class="built_in">ord</span>(<span class="string">&#x27;9&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isAlpha</span>(<span class="params">val</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(val) &gt;= <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">and</span> <span class="built_in">ord</span>(val) &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(val) &gt;= <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">and</span> <span class="built_in">ord</span>(val) &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isDigit</span>(<span class="params">val</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(val) &gt;= <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>) <span class="keyword">and</span> <span class="built_in">ord</span>(val) &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;9&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validIdentifiers</span>(<span class="params">val</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (val[<span class="number">0</span>] == <span class="string">&#x27;_&#x27;</span> <span class="keyword">or</span> isAlpha(val[<span class="number">0</span>])):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(val)):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (val[i] == <span class="string">&#x27;_&#x27;</span> <span class="keyword">or</span> isAlpha(val[i]) <span class="keyword">or</span> isDigit(val[i])):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JackTokenizer</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,infile</span>):</span><br><span class="line">        <span class="comment"># read all source code string to the buffer</span></span><br><span class="line">        self.curr = <span class="number">0</span></span><br><span class="line">        self.buffer = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(infile,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> ifs:</span><br><span class="line">           self.buffer = ifs.read()</span><br><span class="line">        ifs.close()</span><br><span class="line">        self.end = <span class="built_in">len</span>(self.buffer)</span><br><span class="line">        self.tokens = []</span><br><span class="line">        self.linenum = []</span><br><span class="line">        self.parseToken()</span><br><span class="line">        self.outfile = infile[:infile.find(<span class="string">&quot;.jack&quot;</span>)] + <span class="string">&quot;T.xml&quot;</span></span><br><span class="line">        self.genToken()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">parseToken</span>(<span class="params">self</span>):</span><br><span class="line">        pos = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> pos &lt; self.end:</span><br><span class="line">            <span class="comment">#we will skip space</span></span><br><span class="line">            <span class="keyword">if</span> self.buffer[pos] == <span class="string">&#x27; &#x27;</span> <span class="keyword">or</span> \</span><br><span class="line">               self.buffer[pos] == <span class="string">&#x27;\n&#x27;</span> <span class="keyword">or</span> \</span><br><span class="line">               self.buffer[pos] == <span class="string">&#x27;\t&#x27;</span>:</span><br><span class="line">                <span class="keyword">while</span> pos &lt; self.end <span class="keyword">and</span> (self.buffer[pos] == <span class="string">&#x27; &#x27;</span> <span class="keyword">or</span> \</span><br><span class="line">                                          self.buffer[pos] == <span class="string">&#x27;\n&#x27;</span> <span class="keyword">or</span> \</span><br><span class="line">                                          self.buffer[pos] == <span class="string">&#x27;\t&#x27;</span>):</span><br><span class="line">                    pos += <span class="number">1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">            <span class="comment"># we will skip the comment &quot;//&quot;</span></span><br><span class="line">            <span class="keyword">if</span> self.buffer[pos:pos+<span class="number">2</span>] == <span class="string">&quot;//&quot;</span>:</span><br><span class="line">                <span class="keyword">while</span> pos &lt; self.end <span class="keyword">and</span> self.buffer[pos] != <span class="string">&#x27;\n&#x27;</span>:</span><br><span class="line">                    pos += <span class="number">1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># we will skip the comment &quot;/* .. */&quot;</span></span><br><span class="line">            <span class="keyword">if</span> self.buffer[pos:pos+<span class="number">2</span>] == <span class="string">&quot;/*&quot;</span>:</span><br><span class="line">                <span class="keyword">while</span> pos &lt; self.end <span class="keyword">and</span> self.buffer[pos:pos+<span class="number">2</span>] != <span class="string">&quot;*/&quot;</span>:</span><br><span class="line">                    pos += <span class="number">1</span></span><br><span class="line">                pos += <span class="number">2</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">          </span><br><span class="line">            <span class="comment"># check curr token is symbol</span></span><br><span class="line">            <span class="keyword">if</span> self.buffer[pos] <span class="keyword">in</span> symboldict:</span><br><span class="line">                self.tokens.append(self.buffer[pos:pos+<span class="number">1</span>])</span><br><span class="line">                pos += <span class="number">1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># check string constant</span></span><br><span class="line">            <span class="keyword">if</span> pos &lt; self.end <span class="keyword">and</span> self.buffer[pos] == <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">                posCurr = pos</span><br><span class="line">                pos += <span class="number">1</span></span><br><span class="line">                <span class="keyword">while</span> pos &lt; self.end <span class="keyword">and</span> self.buffer[pos] != <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">                    pos += <span class="number">1</span></span><br><span class="line">                pos += <span class="number">1</span></span><br><span class="line">                self.tokens.append(self.buffer[posCurr:pos])</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># check curr token </span></span><br><span class="line">            posCurr = pos</span><br><span class="line">            <span class="keyword">while</span> pos &lt; self.end <span class="keyword">and</span> self.buffer[pos] != <span class="string">&#x27; &#x27;</span> <span class="keyword">and</span> \</span><br><span class="line">                  self.buffer[pos] != <span class="string">&#x27;\n&#x27;</span> <span class="keyword">and</span> self.buffer[pos] <span class="keyword">not</span> <span class="keyword">in</span> symboldict:</span><br><span class="line">                pos += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> pos &gt; posCurr:</span><br><span class="line">                self.tokens.append(self.buffer[posCurr:pos])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span>      </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">hasMoreTokens</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.curr &gt;= <span class="built_in">len</span>(self.tokens) - <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">advance</span>(<span class="params">self</span>):</span><br><span class="line">        self.curr += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">currToken</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.tokens[self.curr]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tokenType</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.getType(self.tokens[self.curr])</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getType</span>(<span class="params">self,token</span>):</span><br><span class="line">        <span class="keyword">if</span> token <span class="keyword">in</span> keworddict:</span><br><span class="line">            <span class="keyword">return</span> TOKEN_TYPE.TOKEN_KEYWORD</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">len</span>(token) == <span class="number">1</span> <span class="keyword">and</span> token[<span class="number">0</span>] <span class="keyword">in</span> symboldict:</span><br><span class="line">            <span class="keyword">return</span> TOKEN_TYPE.TOKEN_SYMBOL</span><br><span class="line">        <span class="keyword">elif</span> validNum(token):</span><br><span class="line">            <span class="keyword">return</span> TOKEN_TYPE.TOKEN_INT_CONST</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">len</span>(token) &gt; <span class="number">1</span> <span class="keyword">and</span> token[<span class="number">0</span>] == <span class="string">&#x27;&quot;&#x27;</span> <span class="keyword">and</span> token[-<span class="number">1</span>] == <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> TOKEN_TYPE.TOKEN_STRING_CONST</span><br><span class="line">        <span class="keyword">elif</span> validIdentifiers(token):</span><br><span class="line">            <span class="keyword">return</span> TOKEN_TYPE.TOKEN_IDENTIFIER</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> TOKEN_TYPE.TOKEN_INVALID</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">keyWord</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.tokens[self.curr]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">symbol</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.tokens[self.curr]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">identifier</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.tokens[self.curr]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">intVal</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.tokens[self.curr]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">stringVal</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.tokens[self.curr][<span class="number">1</span>:-<span class="number">1</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">genToken</span>(<span class="params">self</span>):</span><br><span class="line">        out =  <span class="built_in">open</span>(self.outfile,<span class="string">&quot;w&quot;</span>)</span><br><span class="line">        out.write(<span class="string">&quot;&lt;tokens&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> token <span class="keyword">in</span> self.tokens:</span><br><span class="line">            t = self.getType(token)</span><br><span class="line">            <span class="keyword">if</span> t == TOKEN_TYPE.TOKEN_KEYWORD:</span><br><span class="line">                out.write(<span class="string">&quot;&lt;keyword&gt; &quot;</span>)</span><br><span class="line">                out.write(token)</span><br><span class="line">                out.write(<span class="string">&quot; &lt;/keyword&gt;\n&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> t == TOKEN_TYPE.TOKEN_SYMBOL:</span><br><span class="line">                out.write(<span class="string">&quot;&lt;symbol&gt; &quot;</span>)</span><br><span class="line">                out.write(token)</span><br><span class="line">                out.write(<span class="string">&quot; &lt;/symbol&gt;\n&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> t == TOKEN_TYPE.TOKEN_INT_CONST:</span><br><span class="line">                out.write(<span class="string">&quot;&lt;integerConstant&gt; &quot;</span>)</span><br><span class="line">                out.write(token)</span><br><span class="line">                out.write(<span class="string">&quot; &lt;/integerConstant&gt;\n&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> t == TOKEN_TYPE.TOKEN_STRING_CONST:</span><br><span class="line">                out.write(<span class="string">&quot;&lt;stringConstant&gt; &quot;</span>)</span><br><span class="line">                out.write(token[<span class="number">1</span>:-<span class="number">1</span>])</span><br><span class="line">                out.write(<span class="string">&quot; &lt;/stringConstant&gt;\n&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> t == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">                out.write(<span class="string">&quot;&lt;identifier&gt; &quot;</span>)</span><br><span class="line">                out.write(token)</span><br><span class="line">                out.write(<span class="string">&quot; &lt;/identifier&gt;\n&quot;</span>)</span><br><span class="line">        out.write(<span class="string">&quot;&lt;/tokens&gt;\n&quot;</span>)</span><br><span class="line">        out.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params"><span class="built_in">input</span></span>):</span><br><span class="line">    parser = JackTokenizer(<span class="built_in">input</span>)</span><br><span class="line">    parser.genToken()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main(sys.argv[<span class="number">1</span>])</span><br></pre></td></tr></table></figure></li>
<li><code>compile engine</code>：整个的语法解析器还是非常复杂的，但是实际实现的<code>project</code>可以根据配套的<code>《The Elements of Computing Systems》</code>中的提示，可以很快的将代码解析为几个关键函数的实现即可。<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> JackTokenizer <span class="keyword">import</span> JackTokenizer,TOKEN_TYPE,KEYWORD_TYPE,tokentype,tokendict</span><br><span class="line"><span class="keyword">import</span> fileinput</span><br><span class="line"><span class="keyword">import</span> sys, getopt</span><br><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum, unique</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CompilationEngine</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,infile</span>):</span><br><span class="line">        <span class="comment"># read all source code string to the buffer</span></span><br><span class="line">        self.parser = JackTokenizer(infile)</span><br><span class="line">        outfile = infile[:infile.find(<span class="string">&quot;.jack&quot;</span>)] + <span class="string">&quot;.xml&quot;</span></span><br><span class="line">        self.out = <span class="built_in">open</span>(outfile,<span class="string">&quot;w&quot;</span>)</span><br><span class="line">        self.depth = <span class="number">0</span></span><br><span class="line">        self.compileClass()</span><br><span class="line">        self.out.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">lowerLevel</span>(<span class="params">self</span>):</span><br><span class="line">        self.depth += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">upperLevel</span>(<span class="params">self</span>):</span><br><span class="line">        self.depth -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileOut</span>(<span class="params">self,<span class="built_in">str</span></span>):</span><br><span class="line">        self.out.write(<span class="string">&quot;  &quot;</span>*self.depth)</span><br><span class="line">        self.out.write(<span class="built_in">str</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileOutElement</span>(<span class="params">self,tkType,tkStr</span>):</span><br><span class="line">        self.out.write(<span class="string">&quot;  &quot;</span>*self.depth)</span><br><span class="line">        typeStr = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> tkType == TOKEN_TYPE.TOKEN_KEYWORD:</span><br><span class="line">            typeStr = <span class="string">&quot;keyword&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> tkType == TOKEN_TYPE.TOKEN_SYMBOL:</span><br><span class="line">            typeStr = <span class="string">&quot;symbol&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> tkType == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">            typeStr = <span class="string">&quot;identifier&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> tkType == TOKEN_TYPE.TOKEN_INT_CONST:</span><br><span class="line">            typeStr = <span class="string">&quot;integerConstant&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> tkType == TOKEN_TYPE.TOKEN_STRING_CONST:</span><br><span class="line">            typeStr = <span class="string">&quot;stringConstant&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> tkType == TOKEN_TYPE.TOKEN_INVALID:</span><br><span class="line">            typeStr = <span class="string">&quot;invalid&quot;</span></span><br><span class="line">        self.out.write(<span class="string">&quot;&lt;&quot;</span> + typeStr + <span class="string">&quot;&gt; &quot;</span> + tkStr + <span class="string">&quot; &lt;/&quot;</span> + typeStr + <span class="string">&quot;&gt;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileClass</span>(<span class="params">self</span>):</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;class&gt;\n&quot;</span>)</span><br><span class="line">        self.lowerLevel()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse class</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD  <span class="keyword">and</span> \</span><br><span class="line">           self.parser.keyWord() == <span class="string">&quot;class&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;valid class define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse class name</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;valid class define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse symbol &#x27;&#123;&#x27; </span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">            self.parser.symbol() == <span class="string">&quot;&#123;&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;valid class define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="comment">#parse class val des</span></span><br><span class="line">        <span class="keyword">while</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD <span class="keyword">and</span> \</span><br><span class="line">              (self.parser.keyWord() == <span class="string">&quot;static&quot;</span> <span class="keyword">or</span> self.parser.keyWord() == <span class="string">&quot;field&quot;</span>):</span><br><span class="line">            self.compileClassVarDec()</span><br><span class="line">            </span><br><span class="line">        <span class="comment">#parse class method</span></span><br><span class="line">        <span class="keyword">while</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD <span class="keyword">and</span> \</span><br><span class="line">            (self.parser.keyWord() == <span class="string">&quot;method&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">            self.parser.keyWord() == <span class="string">&quot;constructor&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">            self.parser.keyWord() == <span class="string">&quot;function&quot;</span>):</span><br><span class="line">            self.compileSubroutine()</span><br><span class="line"></span><br><span class="line">        <span class="comment">#parse symbol &#x27;&#123;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">            self.parser.symbol() == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;valid class define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># end of parse class</span></span><br><span class="line">        self.upperLevel()</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;/class&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span>          </span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileClassVarDec</span>(<span class="params">self</span>):</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;classVarDec&gt;\n&quot;</span>)</span><br><span class="line">        self.lowerLevel()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse key word</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD <span class="keyword">and</span> \</span><br><span class="line">          (self.parser.keyWord() == <span class="string">&quot;static&quot;</span> <span class="keyword">or</span> self.parser.keyWord() == <span class="string">&quot;field&quot;</span>):</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;valid val define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse val type</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD <span class="keyword">or</span> \</span><br><span class="line">           self.parser.tokenType() == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;valid val define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse val name</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;valid val define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse the left val name</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> (self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">              self.parser.symbol() == <span class="string">&quot;;&quot;</span>):</span><br><span class="line">            <span class="comment"># parse symbol &#x27;,&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> self.parser.symbol() == <span class="string">&quot;,&quot;</span>:</span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">                self.parser.advance()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;valid val define!\n&quot;</span>)</span><br><span class="line">                exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># parse val name</span></span><br><span class="line">            <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">                self.parser.advance()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;valid val define!\n&quot;</span>)</span><br><span class="line">                exit(<span class="number">1</span>)</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse the end symbol  </span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> self.parser.symbol() == <span class="string">&quot;;&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;valid val define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># end of class var descrtion</span></span><br><span class="line">        self.upperLevel()</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;/classVarDec&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileSubroutine</span>(<span class="params">self</span>):</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;subroutineDec&gt;\n&quot;</span>)</span><br><span class="line">        self.lowerLevel()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse key word</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD  <span class="keyword">and</span> \</span><br><span class="line">           (self.parser.keyWord() == <span class="string">&quot;constructor&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">            self.parser.keyWord() == <span class="string">&quot;function&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">            self.parser.keyWord() == <span class="string">&quot;method&quot;</span>):</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;invalid subroutine!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse type</span></span><br><span class="line">        <span class="keyword">if</span> (self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD  <span class="keyword">and</span> \</span><br><span class="line">           (self.parser.keyWord() == <span class="string">&quot;int&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">            self.parser.keyWord() == <span class="string">&quot;char&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">            self.parser.keyWord() == <span class="string">&quot;void&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">            self.parser.keyWord() == <span class="string">&quot;boolean&quot;</span>)) <span class="keyword">or</span> \</span><br><span class="line">            self.parser.tokenType() == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">           <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD:</span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">                self.parser.advance()</span><br><span class="line">           <span class="keyword">elif</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">                self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;invalid subroutine!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse subroutineName</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;invalid subroutine!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse &#x27;(&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> self.parser.symbol() == <span class="string">&quot;(&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;invalid subroutine!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse param list</span></span><br><span class="line">        self.compileParameterList()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse &#x27;)&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> self.parser.symbol() == <span class="string">&quot;)&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;invalid subroutine!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse body</span></span><br><span class="line">        self.compileSubroutineBody()</span><br><span class="line"></span><br><span class="line">        self.upperLevel()</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;/subroutineDec&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileSubroutineBody</span>(<span class="params">self</span>):</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;subroutineBody&gt;\n&quot;</span>)</span><br><span class="line">        self.lowerLevel()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse &#x27;&#123;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&quot;&#123;&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;inValid sub routine body define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse var </span></span><br><span class="line">        <span class="keyword">while</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD <span class="keyword">and</span> \</span><br><span class="line">           self.parser.keyWord() == <span class="string">&quot;var&quot;</span>:</span><br><span class="line">            self.compileVarDec()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse statements</span></span><br><span class="line">        self.compileStatements()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse &#x27;&#125;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;inValid sub routine body define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        self.upperLevel()</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;/subroutineBody&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileParameterList</span>(<span class="params">self</span>):</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;parameterList&gt;\n&quot;</span>)</span><br><span class="line">        self.lowerLevel()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse rest param</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> (self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span>\</span><br><span class="line">            self.parser.symbol() == <span class="string">&quot;)&quot;</span>):</span><br><span class="line">            <span class="comment"># parse first element type</span></span><br><span class="line">            <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_IDENTIFIER <span class="keyword">or</span> \</span><br><span class="line">               (self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD <span class="keyword">and</span> \</span><br><span class="line">               (self.parser.keyWord() == <span class="string">&quot;int&quot;</span> <span class="keyword">or</span> self.parser.keyWord() == <span class="string">&quot;char&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">                self.parser.keyWord() == <span class="string">&quot;boolean&quot;</span>)):</span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">                self.parser.advance()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># parse first element varName</span></span><br><span class="line">            <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">                self.parser.advance()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># parse &#x27;,&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL:</span><br><span class="line">                <span class="keyword">if</span> self.parser.symbol() == <span class="string">&quot;,&quot;</span>:</span><br><span class="line">                    self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">                    self.parser.advance()</span><br><span class="line">                <span class="keyword">elif</span> self.parser.symbol() == <span class="string">&quot;)&quot;</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;valid param list!\n&quot;</span>)</span><br><span class="line">                    exit(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">str</span>(sys._getframe().f_lineno) + <span class="string">&quot;valid param list!\n&quot;</span>)</span><br><span class="line">                exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        self.upperLevel()</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;/parameterList&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileVarDec</span>(<span class="params">self</span>):</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;varDec&gt;\n&quot;</span>)</span><br><span class="line">        self.lowerLevel()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse key word</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD <span class="keyword">and</span> \</span><br><span class="line">           self.parser.keyWord() == <span class="string">&quot;var&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;valid val define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse var type</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD <span class="keyword">or</span> \</span><br><span class="line">           self.parser.tokenType() == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;valid val define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse var name</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;valid val define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse the rest var name</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> (self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">              self.parser.symbol() == <span class="string">&quot;;&quot;</span>):</span><br><span class="line">            <span class="comment"># parse &quot;,&quot;</span></span><br><span class="line">            <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> self.parser.symbol() == <span class="string">&quot;,&quot;</span>:</span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">                self.parser.advance()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;valid val define!\n&quot;</span>)</span><br><span class="line">                exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># parse var name</span></span><br><span class="line">            <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">                self.parser.advance()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;valid val define!\n&quot;</span>)</span><br><span class="line">                exit(<span class="number">1</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="comment"># parse the end symbol  </span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&quot;;&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;valid var define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># end of class var descrtion</span></span><br><span class="line">        self.upperLevel()</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;/varDec&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span> </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileStatements</span>(<span class="params">self</span>):</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;statements&gt;\n&quot;</span>)</span><br><span class="line">        self.lowerLevel()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD <span class="keyword">and</span> \</span><br><span class="line">             (self.parser.keyWord() == <span class="string">&quot;do&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">              self.parser.keyWord() == <span class="string">&quot;if&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">              self.parser.keyWord() == <span class="string">&quot;while&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">              self.parser.keyWord() == <span class="string">&quot;let&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">              self.parser.keyWord() == <span class="string">&quot;return&quot;</span>):</span><br><span class="line">            <span class="keyword">if</span> self.parser.keyWord() == <span class="string">&quot;do&quot;</span>:</span><br><span class="line">                self.compileDo()</span><br><span class="line">            <span class="keyword">elif</span> self.parser.keyWord() == <span class="string">&quot;if&quot;</span>:</span><br><span class="line">                self.compileIf()</span><br><span class="line">            <span class="keyword">elif</span> self.parser.keyWord() == <span class="string">&quot;while&quot;</span>:</span><br><span class="line">                self.compileWhile()</span><br><span class="line">            <span class="keyword">elif</span> self.parser.keyWord() == <span class="string">&quot;let&quot;</span>:</span><br><span class="line">                self.compileLet()</span><br><span class="line">            <span class="keyword">elif</span> self.parser.keyWord() == <span class="string">&quot;return&quot;</span>:</span><br><span class="line">                self.compileReturn()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;valid statement define!\n&quot;</span>)</span><br><span class="line">                exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        self.upperLevel()</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;/statements&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span> </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileDo</span>(<span class="params">self</span>):</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;doStatement&gt;\n&quot;</span>)</span><br><span class="line">        self.lowerLevel()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse do</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD <span class="keyword">and</span> \</span><br><span class="line">           self.parser.keyWord() == <span class="string">&quot;do&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.keyWord())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;inValid do  define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse &#x27;(&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> (self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&quot;(&quot;</span>):</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse &#x27;(&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&quot;(&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;inValid do statement  define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse expression list</span></span><br><span class="line">        self.compileExpressionList()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse &#x27;)&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&quot;)&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;inValid do statement body define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse  &#x27;;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&#x27;;&#x27;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;inValid do statement  define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">        self.upperLevel()</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;/doStatement&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileLet</span>(<span class="params">self</span>):</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;letStatement&gt;\n&quot;</span>)</span><br><span class="line">        self.lowerLevel()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse let </span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD <span class="keyword">and</span> \</span><br><span class="line">           self.parser.keyWord() == <span class="string">&quot;let&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.keyWord())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;inValid let  define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse varname</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.identifier())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;inValid let  define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse `[expression]`</span></span><br><span class="line">        <span class="keyword">while</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">              self.parser.symbol() == <span class="string">&#x27;[&#x27;</span>:</span><br><span class="line">            <span class="comment"># parse &#x27;[&#x27;</span></span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># parse expression</span></span><br><span class="line">            self.compileExpression()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># parse &#x27;]&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">               self.parser.symbol() == <span class="string">&#x27;]&#x27;</span>:</span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">                self.parser.advance()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;inValid let  define!\n&quot;</span>)</span><br><span class="line">                exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse  &#x27;=&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;inValid let  define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse expression</span></span><br><span class="line">        self.compileExpression()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse  &#x27;;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&#x27;;&#x27;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;inValid let  define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">        self.upperLevel()</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;/letStatement&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileWhile</span>(<span class="params">self</span>):</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;whileStatement&gt;\n&quot;</span>)</span><br><span class="line">        self.lowerLevel()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse return </span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD <span class="keyword">and</span> \</span><br><span class="line">           self.parser.keyWord() == <span class="string">&quot;while&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.keyWord())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;inValid while  define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse &#x27;(&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&#x27;(&#x27;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;inValid while  define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse expression</span></span><br><span class="line">        self.compileExpression()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse  &#x27;)&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&#x27;)&#x27;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;inValid while  define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse  &#x27;&#123;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&#x27;&#123;&#x27;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;inValid while  define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse statements</span></span><br><span class="line">        self.compileStatements()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse  &#x27;&#125;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;inValid while  define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        self.upperLevel()</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;/whileStatement&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileReturn</span>(<span class="params">self</span>):</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;returnStatement&gt;\n&quot;</span>)</span><br><span class="line">        self.lowerLevel()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse return </span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD <span class="keyword">and</span> \</span><br><span class="line">           self.parser.keyWord() == <span class="string">&quot;return&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.keyWord())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;valid if return statement!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse expression  list</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&#x27;;&#x27;</span>):</span><br><span class="line">            self.compileExpression()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse &#x27;;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&#x27;;&#x27;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;valid if return statement!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        self.upperLevel()</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;/returnStatement&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileIf</span>(<span class="params">self</span>):</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;ifStatement&gt;\n&quot;</span>)</span><br><span class="line">        self.lowerLevel()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse if </span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD <span class="keyword">and</span> \</span><br><span class="line">           self.parser.keyWord() == <span class="string">&quot;if&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.keyWord())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;valid if define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse &#x27;(&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&quot;(&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;valid if define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse expression</span></span><br><span class="line">        self.compileExpression()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse &#x27;)&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&quot;)&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;valid if define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse &#x27;&#123;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&quot;&#123;&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;valid if define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse statements</span></span><br><span class="line">        self.compileStatements()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse &#x27;&#125;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           self.parser.symbol() == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;valid if define!\n&quot;</span>)</span><br><span class="line">            exit(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># parse else</span></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD <span class="keyword">and</span> \</span><br><span class="line">           self.parser.keyWord() == <span class="string">&quot;else&quot;</span>:</span><br><span class="line">            <span class="comment"># parse &#x27;else&#x27;</span></span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.keyWord())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># parse &#x27;&#123;&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">            self.parser.symbol() == <span class="string">&quot;&#123;&quot;</span>:</span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">                self.parser.advance()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;valid if define!\n&quot;</span>)</span><br><span class="line">                exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># parse statements</span></span><br><span class="line">            self.compileStatements()</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># parse &#x27;&#125;&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">            self.parser.symbol() == <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">                self.parser.advance()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;valid if define!\n&quot;</span>)</span><br><span class="line">                exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        self.upperLevel()</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;/ifStatement&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileExpression</span>(<span class="params">self</span>):</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;expression&gt;\n&quot;</span>)</span><br><span class="line">        self.lowerLevel()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse term</span></span><br><span class="line">        self.compileTerm()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse op</span></span><br><span class="line">        <span class="keyword">while</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">           (self.parser.symbol() == <span class="string">&quot;+&quot;</span> <span class="keyword">or</span> self.parser.symbol() == <span class="string">&quot;-&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">            self.parser.symbol() == <span class="string">&quot;*&quot;</span> <span class="keyword">or</span> self.parser.symbol() == <span class="string">&quot;/&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">            self.parser.symbol() == <span class="string">&quot;&amp;&quot;</span> <span class="keyword">or</span> self.parser.symbol() == <span class="string">&quot;|&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">            self.parser.symbol() == <span class="string">&quot;&gt;&quot;</span> <span class="keyword">or</span> self.parser.symbol() == <span class="string">&quot;&lt;&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">            self.parser.symbol() == <span class="string">&quot;=&quot;</span>):</span><br><span class="line">            <span class="comment"># parse op</span></span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># parse term</span></span><br><span class="line">            self.compileTerm()</span><br><span class="line">        </span><br><span class="line">        self.upperLevel()</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;/expression&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileTerm</span>(<span class="params">self</span>):</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;term&gt;\n&quot;</span>)</span><br><span class="line">        self.lowerLevel()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_INT_CONST:</span><br><span class="line">            <span class="comment"># parse int const</span></span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.intVal())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">elif</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_STRING_CONST:</span><br><span class="line">            <span class="comment"># parse string const</span></span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.stringVal())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">        <span class="keyword">elif</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_KEYWORD:</span><br><span class="line">            <span class="comment"># parse keword const</span></span><br><span class="line">            <span class="keyword">if</span> self.parser.keyWord() == <span class="string">&quot;true&quot;</span> <span class="keyword">or</span> self.parser.keyWord() == <span class="string">&quot;false&quot;</span> <span class="keyword">or</span> \</span><br><span class="line">               self.parser.keyWord() == <span class="string">&quot;null&quot;</span> <span class="keyword">or</span> self.parser.keyWord() == <span class="string">&quot;this&quot;</span>:</span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.keyWord())</span><br><span class="line">                self.parser.advance()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;inValid expression define!\n&quot;</span>)</span><br><span class="line">                exit(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL:</span><br><span class="line">            <span class="keyword">if</span> self.parser.symbol() == <span class="string">&quot;(&quot;</span>:</span><br><span class="line">                <span class="comment"># parse &#x27;(&#x27;</span></span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">                self.parser.advance()</span><br><span class="line">                <span class="comment"># parse expression</span></span><br><span class="line">                self.compileExpression()</span><br><span class="line">                <span class="comment"># parse &#x27;)&#x27;</span></span><br><span class="line">                <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">                   self.parser.symbol() == <span class="string">&quot;)&quot;</span>:</span><br><span class="line">                    self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">                    self.parser.advance()</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;valid term define!\n&quot;</span>)</span><br><span class="line">                    exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> \</span><br><span class="line">                (self.parser.symbol() == <span class="string">&quot;-&quot;</span> <span class="keyword">or</span> self.parser.symbol() == <span class="string">&quot;~&quot;</span>):</span><br><span class="line">                <span class="comment"># parse unaryOp</span></span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">                self.parser.advance()</span><br><span class="line">                <span class="comment"># parse term</span></span><br><span class="line">                self.compileTerm()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;valid term define!\n&quot;</span>)</span><br><span class="line">                exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">            <span class="comment"># parse subroutineName or varName</span></span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">            self.parser.advance()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># parse expression</span></span><br><span class="line">            <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> self.parser.symbol() == <span class="string">&quot;[&quot;</span>:</span><br><span class="line">                <span class="comment"># parse &#x27;[&#x27;</span></span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">                self.parser.advance()</span><br><span class="line">                <span class="comment"># parse expression</span></span><br><span class="line">                self.compileExpression()</span><br><span class="line">                <span class="comment"># parse &#x27;]&#x27;</span></span><br><span class="line">                <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> self.parser.symbol() == <span class="string">&quot;]&quot;</span>:</span><br><span class="line">                    self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">                    self.parser.advance()</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;valid term define!\n&quot;</span>)</span><br><span class="line">                    exit(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">elif</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> self.parser.symbol() == <span class="string">&quot;.&quot;</span>:</span><br><span class="line">                <span class="comment"># parse &#x27;.&#x27;</span></span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">                self.parser.advance()</span><br><span class="line"></span><br><span class="line">                <span class="comment"># parse subroutineName</span></span><br><span class="line">                <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_IDENTIFIER:</span><br><span class="line">                    self.compileOutElement(self.parser.tokenType(),self.parser.currToken())</span><br><span class="line">                    self.parser.advance()</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;valid term define!\n&quot;</span>)</span><br><span class="line">                    exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># parse &#x27;(&#x27;</span></span><br><span class="line">                <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> self.parser.symbol() == <span class="string">&quot;(&quot;</span>:</span><br><span class="line">                    self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">                    self.parser.advance()</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;valid term define!\n&quot;</span>)</span><br><span class="line">                    exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># parse expressList</span></span><br><span class="line">                self.compileExpressionList()</span><br><span class="line"></span><br><span class="line">                <span class="comment"># parse &#x27;)&#x27;</span></span><br><span class="line">                <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> self.parser.symbol() == <span class="string">&quot;)&quot;</span>:</span><br><span class="line">                    self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">                    self.parser.advance()</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;valid term define!\n&quot;</span>)</span><br><span class="line">                    exit(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">elif</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> self.parser.symbol() == <span class="string">&quot;(&quot;</span>:</span><br><span class="line">                self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">                self.parser.advance()</span><br><span class="line"></span><br><span class="line">                <span class="comment"># parse expressList</span></span><br><span class="line">                self.compileExpressionList()</span><br><span class="line"></span><br><span class="line">                <span class="comment"># parse &#x27;)&#x27;</span></span><br><span class="line">                <span class="keyword">if</span> self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL <span class="keyword">and</span> self.parser.symbol() == <span class="string">&quot;)&quot;</span>:</span><br><span class="line">                    self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">                    self.parser.advance()</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;valid term define!\n&quot;</span>)</span><br><span class="line">                    exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        self.upperLevel()</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;/term&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compileExpressionList</span>(<span class="params">self</span>):</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;expressionList&gt;\n&quot;</span>)</span><br><span class="line">        self.lowerLevel()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.parser.symbol() == <span class="string">&#x27;)&#x27;</span> <span class="keyword">and</span> \</span><br><span class="line">           self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL:</span><br><span class="line">            self.upperLevel()</span><br><span class="line">            self.compileOut(<span class="string">&quot;&lt;/expressionList&gt;\n&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse expression</span></span><br><span class="line">        self.compileExpression()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># parse `, expression`</span></span><br><span class="line">        <span class="keyword">while</span> self.parser.symbol() == <span class="string">&#x27;,&#x27;</span> <span class="keyword">and</span> \</span><br><span class="line">              self.parser.tokenType() == TOKEN_TYPE.TOKEN_SYMBOL:</span><br><span class="line">            <span class="comment"># parse &#x27;,&#x27;</span></span><br><span class="line">            self.compileOutElement(self.parser.tokenType(),self.parser.symbol())</span><br><span class="line">            self.parser.advance()</span><br><span class="line">            <span class="comment"># parse expression</span></span><br><span class="line">            self.compileExpression()</span><br><span class="line"></span><br><span class="line">        self.upperLevel()</span><br><span class="line">        self.compileOut(<span class="string">&quot;&lt;/expressionList&gt;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params"><span class="built_in">input</span></span>):</span><br><span class="line">    parser = CompilationEngine(<span class="built_in">input</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main(sys.argv[<span class="number">1</span>])</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>欢迎关注和打赏，感谢支持！</p>
<ul>
<li>关注我的博客: <a target="_blank" rel="noopener" href="http://mikemeng.org/">http://mikemeng.org/</a></li>
<li>关注我的知乎：<a target="_blank" rel="noopener" href="https://www.zhihu.com/people/da-hua-niu">https://www.zhihu.com/people/da-hua-niu</a></li>
<li>关注我的微信公众号: 公务程序猿<br><img src="https://i.loli.net/2020/11/16/xtyDOgT6Gm1AKdS.png" alt="1"></li>
</ul>
</section>
    <!-- Tags START -->
    
      <div class="tags">
        <span>Tags:</span>
        
  <a href="/tags#公开课学习" >
    <span class="tag-code">公开课学习</span>
  </a>

      </div>
    
    <!-- Tags END -->
    <!-- NAV START -->
    
  <div class="nav-container">
    <!-- reverse left and right to put prev and next in a more logic postition -->
    
      <a class="nav-left" href="/2022/11/20/%E5%85%AC%E5%BC%80%E8%AF%BE%E5%AD%A6%E4%B9%A0/81/">
        <span class="nav-arrow">← </span>
        
          【CSAPP】 lab3
        
      </a>
    
    
      <a class="nav-right" href="/2022/11/20/%E5%85%AC%E5%BC%80%E8%AF%BE%E5%AD%A6%E4%B9%A0/83/">
        
          【MIT6.S081】lab10 mmap
        
        <span class="nav-arrow"> →</span>
      </a>
    
  </div>

    <!-- NAV END -->
    <!-- 二维码 START -->
    
      <div class="qrcode">
        <canvas id="share-qrcode"></canvas>
        <p class="notice">扫描二维码，分享此文章</p>
      </div>
    
    <!-- 二维码 END -->
    
      <!-- Utterances START -->
      <div id="utterances"></div>
      <script src="https://utteranc.es/client.js"
        repo="mike-box/blogtalk"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async></script>    
      <!-- Utterances END -->
    
  </article>
  <!-- Article END -->
  <!-- Catalog START -->
  
    <aside class="catalog-container">
  <div class="toc-main">
    <strong class="toc-title">Catalog</strong>
    
      <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#week9"><span class="toc-nav-text">week9</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#project"><span class="toc-nav-text">project</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link"><span class="toc-nav-text"></span></a></li></ol></li></ol></li></ol>
    
  </div>
</aside>
  
  <!-- Catalog END -->
</main>

<script>
  (function () {
    var url = 'http://example.com/2022/11/20/公开课学习/80/';
    var banner = ''
    if (banner !== '' && banner !== 'undefined' && banner !== 'null') {
      $('#article-banner').css({
        'background-image': 'url(' + banner + ')'
      })
    } else {
      $('#article-banner').geopattern(url)
    }
    $('.header').removeClass('fixed-header')

    // error image
    $(".markdown-content img").on('error', function() {
      $(this).attr('src', '/css/images/error_icon.png')
      $(this).css({
        'cursor': 'default'
      })
    })

    // zoom image
    $(".markdown-content img").on('click', function() {
      var src = $(this).attr('src')
      if (src !== '/css/images/error_icon.png') {
        var imageW = $(this).width()
        var imageH = $(this).height()

        var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
        zoom = zoom < 1 ? 1 : zoom
        zoom = zoom > 2 ? 2 : zoom
        var transY = (($(window).height() - imageH) / 2).toFixed(2)

        $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
        $('.image-view-wrap').addClass('wrap-active')
        $('.image-view-wrap img').css({
          'width': `${imageW}`,
          'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
        })
        $('html').css('overflow', 'hidden')

        $('.image-view-wrap').on('click', function() {
          $(this).remove()
          $('html').attr('style', '')
        })
      }
    })
  })();
</script>


  <script>
    var qr = new QRious({
      element: document.getElementById('share-qrcode'),
      value: document.location.href
    });
  </script>







  <script src='https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js'></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize({theme: 'forest'});
    }
  </script>


    <div class="scroll-top">
  <span class="arrow-icon"></span>
</div>
    <footer class="app-footer">
  <p class="copyright">
    &copy; 2024 | Proudly powered by <a href="https://hexo.io" target="_blank">Hexo</a>
    <br>
    
  </p>
  <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
</footer>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script>
  function async(u, c) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
</script>
<script>
  async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
    FastClick.attach(document.body);
  })
</script>

<script>
  var hasLine = 'false';
  async("//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js", function(){
    $('figure pre').each(function(i, block) {
      var figure = $(this).parents('figure');
      if (hasLine === 'false') {
        figure.find('.gutter').hide();
      }
      hljs.configure({useBR: true});
      var lang = figure.attr('class').split(' ')[1] || 'code';
      var codeHtml = $(this).html();
      var codeTag = document.createElement('code');
      codeTag.className = lang;
      codeTag.innerHTML = codeHtml;
      $(this).attr('class', '').empty().html(codeTag);
      figure.attr('data-lang', lang.toUpperCase());
      hljs.highlightBlock(block);
    });
  })
</script>



<!-- Baidu Tongji -->


<script src="/js/script.js"></script>



  <script src='https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js'></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize({theme: 'forest'});
    }
  </script>


  </body>
</html>